<%
String.prototype.sanitaze = function () {
  return this.replace(/\\/g, '\\\\').replace(/\n/g, '').replace(/\"/g, '\\"').replace(/\\\\\\\\/g, '\\\\')
}
String.prototype.wrapper = function () {
  const prefix = `
<div class="mkz-wf mkz-wf_uid_{{ uid }} mkz-wf_state_{{ state }}{% if is_hidden %} mkz-wf_type_hidden{% endif %} mkz-wf_close-animation_{{close_animation_type}} mkz-wf_show-animation_{{show_animation_type}}{% if show_animation %} mkz-wf_animation_show{% endif %}{% if close_animation %} mkz-wf_animation_hide{% endif %}">
  <div class="mkz-wf__overlay mkz-js-overlay"></div>
  <div class="mkz-wf__align">
    <div class="mkz-wf__body-wrap">
      <div class="mkz-wf__body">
        {% if allow_close %}
          <div class="mkz-wf__close mkz-js-close"{% if close_color %} style="color: {{ close_color }}"{% endif %}></div>
        {% endif %}
        {% if allow_brand %}
          <a href="https://markeaze.ru" class="mkz-wf__brand" target="_blank">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
               viewBox="0 0 48 32" style="enable-background:new 0 0 48 32;" xml:space="preserve" width="48" height="33" class="mkz-wf__brand-img mkz-wf__brand-img_type_small">
            <style type="text/css">
              .st0{fill:none;stroke:#37404F;stroke-width:0.5;stroke-miterlimit:10;}
              .st1{fill:#DA4765;}
              .st2{fill:#70C340;}
              .st3{fill:#6D61FA;}
            </style>
            <g>
              <g>
                <line class="st0" x1="938.3" y1="11.2" x2="947.6" y2="20.5"/>
                <line class="st0" x1="947.6" y1="11.2" x2="938.3" y2="20.5"/>
              </g>
              <g>
                <polygon class="st1" points="5.3,31.7 0.4,28.6 0.4,28.6 12.2,9.6 12.2,9.6 17.1,12.7 5.3,31.7"/>
                <polygon class="st2" points="18,31.6 13,28.5 13,28.5 27.2,5.5 27.2,5.5 32.2,8.6 18,31.6"/>
                <polygon class="st3" points="30.4,31.6 25.5,28.5 25.5,28.5 43.1,0 43.1,0 48.1,3.1 30.5,31.6"/>
              </g>
            </g>
            </svg>
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
               viewBox="0 0 45 9" style="enable-background:new 0 0 45 9;" xml:space="preserve" width="65" height="15" class="mkz-wf__brand-img mkz-wf__brand-img_type_big">
              <g>
                <g>
                  <g>
                    <g>
                      <path style="fill:#37404F;" d="M13.5,4l0.8,0l0,0.7l0,0c0.1-0.2,0.2-0.4,0.4-0.5c0.2-0.1,0.4-0.2,0.7-0.2c0.6,0,0.9,0.3,1.1,0.8l0,0
                        c0.1-0.2,0.3-0.4,0.5-0.6C17.2,4,17.5,4,17.8,4c0.4,0,0.7,0.1,0.9,0.4C18.9,4.6,19,4.9,19,5.3L19,8l-0.8,0l0-2.5
                        c0-0.3-0.1-0.5-0.2-0.6c-0.1-0.1-0.3-0.2-0.6-0.2c-0.2,0-0.4,0.1-0.6,0.2c-0.2,0.2-0.2,0.4-0.2,0.6l0,2.5l-0.8,0l0-2.6
                        c0-0.2-0.1-0.4-0.2-0.5c-0.1-0.1-0.3-0.2-0.6-0.2c-0.2,0-0.4,0.1-0.6,0.3c-0.2,0.2-0.2,0.4-0.2,0.6l0,2.4l-0.8,0L13.5,4z"/>
                      <path style="fill:#37404F;" d="M20,7.7c-0.2-0.2-0.4-0.5-0.4-0.9c0-0.3,0.1-0.6,0.4-0.8c0.3-0.2,0.6-0.3,1.1-0.3l1.1-0.1l0-0.3
                        c0-0.2-0.1-0.4-0.2-0.5c-0.1-0.1-0.3-0.2-0.6-0.2c-0.2,0-0.4,0-0.5,0.1c-0.1,0.1-0.2,0.2-0.3,0.4l-0.7,0c0-0.3,0.2-0.6,0.5-0.9
                        C20.6,4.1,21,4,21.4,4c0.5,0,0.9,0.1,1.2,0.4C22.9,4.6,23,4.9,23,5.3L23,8l-0.8,0l0-0.7l0,0c-0.1,0.2-0.3,0.4-0.5,0.5
                        C21.5,7.9,21.2,8,21,8C20.6,8,20.3,7.9,20,7.7z M21.9,7.1c0.2-0.2,0.3-0.4,0.3-0.6l0-0.3l-1,0.1c-0.5,0-0.8,0.2-0.8,0.6
                        c0,0.2,0.1,0.3,0.2,0.4c0.1,0.1,0.3,0.2,0.5,0.2C21.5,7.4,21.7,7.3,21.9,7.1z"/>
                      <path style="fill:#37404F;" d="M23.8,4l0.8,0l0,0.7l0,0c0.1-0.2,0.2-0.4,0.4-0.5C25.1,4.1,25.3,4,25.5,4c0.1,0,0.2,0,0.3,0l0,0.7
                        c-0.1,0-0.2-0.1-0.3-0.1c-0.3,0-0.5,0.1-0.6,0.2c-0.2,0.2-0.2,0.4-0.2,0.7l0,2.4l-0.8,0L23.8,4z"/>
                      <path style="fill:#37404F;" d="M28.8,4.1l0.9,0L28,5.8L29.7,8l-0.9,0l-1.4-1.8l-0.3,0.3l0,1.4l-0.8,0l0-5.5l0.8,0l0,3.2L28.8,4.1z"/>
                      <path style="fill:#37404F;" d="M33.3,6.9c-0.1,0.4-0.2,0.6-0.6,0.9c-0.3,0.2-0.7,0.3-1.1,0.3c-0.6,0-1-0.2-1.4-0.6
                        c-0.3-0.4-0.5-0.9-0.5-1.5c0-0.6,0.2-1.1,0.5-1.5C30.6,4.2,31.1,4,31.6,4c0.5,0,1,0.2,1.3,0.5c0.3,0.4,0.5,0.8,0.5,1.4l0,0.3
                        l-2.8,0l0,0c0,0.3,0.1,0.6,0.3,0.8c0.2,0.2,0.5,0.3,0.8,0.3c0.2,0,0.4,0,0.6-0.1c0.2-0.1,0.3-0.2,0.3-0.4L33.3,6.9z M30.9,5
                        c-0.2,0.2-0.3,0.4-0.3,0.7l2,0c0-0.3-0.1-0.6-0.3-0.7c-0.2-0.2-0.4-0.3-0.7-0.3C31.3,4.7,31.1,4.8,30.9,5z"/>
                      <path style="fill:#37404F;" d="M34.2,7.8c-0.2-0.2-0.4-0.5-0.4-0.9c0-0.3,0.1-0.6,0.4-0.8c0.3-0.2,0.6-0.3,1.1-0.3l1.1-0.1l0-0.3
                        c0-0.2-0.1-0.4-0.2-0.5c-0.1-0.1-0.3-0.2-0.6-0.2c-0.2,0-0.4,0-0.5,0.1c-0.1,0.1-0.2,0.2-0.3,0.4l-0.7,0c0-0.3,0.2-0.6,0.5-0.9
                        c0.3-0.2,0.7-0.3,1.1-0.3c0.5,0,0.9,0.1,1.2,0.4c0.3,0.2,0.4,0.6,0.4,0.9l0,2.7l-0.8,0l0-0.7l0,0c-0.1,0.2-0.3,0.4-0.5,0.5
                        c-0.2,0.1-0.5,0.2-0.7,0.2C34.8,8.1,34.5,8,34.2,7.8z M36.1,7.2c0.2-0.2,0.3-0.4,0.3-0.6l0-0.3l-1,0.1c-0.5,0-0.8,0.2-0.8,0.6
                        c0,0.2,0.1,0.3,0.2,0.4c0.1,0.1,0.3,0.2,0.5,0.2C35.7,7.5,35.9,7.4,36.1,7.2z"/>
                      <path style="fill:#37404F;" d="M37.9,7.6L40,4.8v0l-2.1,0l0-0.6l3,0l0,0.5l-2.1,2.8l0,0l2.1,0l0,0.6l-3,0L37.9,7.6z"/>
                      <path style="fill:#37404F;" d="M44.9,7c-0.1,0.4-0.2,0.6-0.6,0.9c-0.3,0.2-0.7,0.3-1.1,0.3c-0.6,0-1-0.2-1.4-0.6c-0.3-0.4-0.5-0.9-0.5-1.5
                        c0-0.6,0.2-1.1,0.5-1.5c0.3-0.4,0.8-0.6,1.3-0.5c0.5,0,1,0.2,1.3,0.5C44.8,5,45,5.5,45,6.1l0,0.3l-2.8,0l0,0
                        c0,0.3,0.1,0.6,0.3,0.8c0.2,0.2,0.5,0.3,0.8,0.3c0.2,0,0.4,0,0.6-0.1C44,7.3,44.1,7.1,44.2,7L44.9,7z M42.5,5
                        c-0.2,0.2-0.3,0.4-0.3,0.7l2,0c0-0.3-0.1-0.6-0.3-0.7c-0.2-0.2-0.4-0.3-0.7-0.3C42.9,4.8,42.7,4.8,42.5,5z"/>
                    </g>
                    <g>
                      <polygon style="fill:#DA4765;" points="1.8,7.9 0.5,7.1 0.5,7.1 3.7,2.2 3.7,2.2 5,3 1.8,7.9"/>
                      <polygon style="fill:#70C340;" points="5.2,7.9 3.9,7.1 3.9,7.1 7.6,1.1 7.6,1.1 8.9,1.9 5.2,7.9"/>
                      <polygon style="fill:#6D61FA;" points="8.4,8 7.1,7.2 7.1,7.2 11.8,-0.3 11.8,-0.3 13.1,0.5 8.4,8"/>
                    </g>
                  </g>
                </g>
              </g>
            </svg>
          </a>
        {% endif %}
        <div class="mkz-wf__content">
          <div class="mkz-wf__workarea mkz-js-workarea">
`
  const postfix = `
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
`
  return (prefix + this + postfix).sanitaze()
}

const commonWrapper = `<div mkz class=\"mkz mkz-js-main\">\n<style type=\"text/css\">
${require('raw-loader!sass-loader!./assets/stylesheets/app.sass').sanitaze()}
</style>\n  <div class=\"mkz-js-ribbons\"></div>\n  <div class=\"mkz-js-wfs\"></div>\n</div>`
const ribbonsWrapper = `{% for ribbon_type in ribbon_types %}\n  <div class=\"mkz-ribbon mkz-ribbon_type_{{ ribbon_type }}\">\n\n    {% for options in web_forms %}\n      {% if options.ribbon_type == ribbon_type %}\n        <div class=\"mkz-js-ribbon-{{ options.id }} mkz-ribbon__item{% if options.is_hidden != true %} mkz-ribbon__item_state_hidden{% endif %}\">\n          <div class=\"mkz-ribbon__label\">\n            {{ options.ribbon_label }}\n          </div>\n          {% if options.ribbon_picture %}\n            <img class=\"mkz-ribbon__picture\" src=\"{{ options.ribbon_picture }}\" alt=\"\" />\n          {% endif %}\n        </div>\n      {% endif %}\n    {% endfor %}\n\n  </div>\n{% endfor %}`
%>
{
  "assets": {
    "version": "${new Date()}",
    "web_forms_common_wrapper":  "${commonWrapper.sanitaze()}",
    "web_forms_ribbons_wrapper": "${ribbonsWrapper.sanitaze()}",
    "web_forms_css": "[mkz] .mkz-wf_uid_w22 .mkz-wf__inner{position:relative;z-index:10;}[mkz] .mkz-wf_uid_w22 {  right: 30px;  bottom: 30px;  z-index: 10017;  max-width: 90%;  left: 50px;  bottom: 30px; }  [mkz] .mkz-wf_uid_w22 .mkz-wf__close {    top: -15px;    right: 1px;    width: 13px;    height: 13px;    font-size: 10px;    line-height: 10px; }  [mkz] .mkz-wf_uid_w22 .mkz-wf__body {    background-color: #fff;    border: 1px solid #475462;    padding: 15px 50px 15px 106px;    width: 537px;    min-height: 145px; }  [mkz] .mkz-wf_uid_w22 .mkz-wf__close {    top: 5px;    right: 5px;    width: 20px;    height: 20px;    font-size: 12px;    line-height: 18px; }  [mkz] .mkz-wf_uid_w22 .mkz-wf__brand {    top: auto;    bottom: -20px;    right: 0; }  [mkz] .mkz-wf_uid_w22 .mkz-wf__picture-d {    position: absolute;    left: -49px;    top: -120px; }  [mkz] .mkz-wf_uid_w22 .mkz-wf__title {    font-size: 24px;    line-height: 1.25em;    color: #fc4566;    margin-bottom: 9px; }  [mkz] .mkz-wf_uid_w22 .mkz-wf__text {    font-size: 17px;    line-height: 1.25em;    margin-bottom: 19px; }  [mkz] .mkz-wf_uid_w22 .mkz-wf__list-i {    position: relative;    font-size: 20px;    line-height: 1.25em;    padding: 15px 0 15px 83px; }  [mkz] .mkz-wf_uid_w22 .mkz-wf__list-ico {    position: absolute;    left: 0;    top: 0; }  [mkz] .mkz-wf_uid_w22 .mkz-wf__picture-m {    margin: -60px auto 8px auto; }  @media screen and (max-width: 800px) {    [mkz] .mkz-wf_uid_w22 {      position: static; }      [mkz] .mkz-wf_uid_w22 .mkz-wf__body-wrap {        position: fixed;        right: 0;        left: 0;        bottom: 0;        top: 0;        z-index: 10060;        overflow: auto; }      [mkz] .mkz-wf_uid_w22 .mkz-wf__body {        width: auto;        height: auto;        min-height: 100%;        min-width: 0;        box-shadow: none; }      [mkz] .mkz-wf_uid_w22 .mkz-wf__workarea {        flex: 1 0; }      [mkz] .mkz-wf_uid_w22 .mkz-wf__brand {        left: 50%;        top: auto;        bottom: 40px;        right: auto;        margin-left: -32px; }      [mkz] .mkz-wf_uid_w22 .mkz-wf__body {        border-style: none;        padding: 32px 15px 76px 15px; }      [mkz] .mkz-wf_uid_w22 .mkz-wf__form-g {        display: block; }      [mkz] .mkz-wf_uid_w22 .mkz-wf__form-g-input {        margin-bottom: 10px; }      [mkz] .mkz-wf_uid_w22 .mkz__btn {        display: block;        font-size: 20px; }      [mkz] .mkz-wf_uid_w22 .mkz-wf__title {        font-size: 26px;        line-height: 1.25em;        text-align: center;        margin-bottom: 10px; }      [mkz] .mkz-wf_uid_w22 .mkz-wf__title-main {        font-size: 56px;        line-height: 1.25em;        display: block;        margin-bottom: 2px; } }",
    "locale": "en",
    "chat_settings": {
      "common":{
        "enabled": true,
        "title_bg": "#F28E24",
        "agent_post": true,
        "title_color": "#fff",
        "agent_avatar": true,
        "agent_msg_bg": "#E7FEEA",
        "client_msg_bg": "#FFFFFF",
        "markeaze_link": true,
        "agent_sound_path": "https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/livechat/sounds/new_message",
        "client_sound_path": "https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/livechat/sounds/diversity"
      },
      "mobile": {
        "bar_bg": "#F28E24",
        "bar_type": "bubble",
        "bar_color": "#000",
        "notice_bg": "#333",
        "notice_text": "Looking for halloween gifts?",
        "bar_position": "r-b",
        "notice_color": "#fff",
        "bar_padding_x": "20",
        "bar_padding_y": "20",
        "bar_text_online": "Leave message",
        "notice_icon_url": "https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/livechat/icons/halloween.png",
        "bar_text_offline": "We’re here. Let’s chat!"
      },
      "desktop": {
        "bar_bg": "#FC4566",
        "bar_type": "bar",
        "bar_color": "#fff",
        "notice_bg": "#7261FF",
        "notice_text": "NEED HELP?",
        "bar_position": "r-b",
        "notice_color": "#fff",
        "bar_padding_x": "20",
        "bar_padding_y": "20",
        "bar_text_online": "We’re here. Let’s chat!",
        "bar_text_offline": "Leave message"
      }
    }
  },
  "status": "OK",
  "web_forms": [
    {
      "uid": "w22",
      "can_be_hidden": false,
      "states": ["default", "thank_you"],
      "ribbon_label": null,
      "ribbon_type": "aside",
      "callbacks": {},
      "body_html": "<%= `
{% if state == 'default' %}<img src="https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/w22/shop_list_d.svg" class="mkz-wf__picture-d mkz__d-desktop" alt="" /><div class="mkz-wf__inner"><div class="mkz-wf__title">  <span class="mkz-wf__title-main">Прислать</span> список магазинов?</div><div class="mkz-wf__text mkz__d-desktop">Карта, адреса, телефоны и время работы</div><div class="mkz-wf__list mkz__d-mobile">  <div class="mkz-wf__list-i">    <img src="https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/w22/shop_list_time.svg" class="mkz-wf__list-ico" alt="" />    Время работы  </div>  <div class="mkz-wf__list-i">    <img src="https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/w22/shop_list_phone.svg" class="mkz-wf__list-ico" alt="" />    Телефон  </div>  <div class="mkz-wf__list-i">    <img src="https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/w22/shop_list_mail.svg" class="mkz-wf__list-ico" alt="" />    Адреса  </div>  <div class="mkz-wf__list-i">    <img src="https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/w22/shop_list_map.svg" class="mkz-wf__list-ico" alt="" />    Карта  </div></div><img src="https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/w22/shop_list_m.svg" class="mkz-wf__picture-m mkz__d-mobile" alt="" /><div class="mkz-wf__form-g">  <input type="email" name="email" required placeholder="Введите свой E-mail" class="mkz__input mkz-wf__form-g-input" />  <div class="mkz__btn mkz-wf__form-g-btn" role="submit">Отправить</div></div>{% endif %}{% if state == 'thank_you' %}<img src="https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/w22/shop_list_d.svg" class="mkz-wf__picture-d mkz__d-desktop" alt="" /><img src="https://markeaze-themes.s3.eu-central-1.amazonaws.com/default/w22/shop_list_m.svg" class="mkz-wf__picture-m mkz__d-mobile" alt="" /><div class="mkz-wf__title">  Контакты были отправлены на почту</div>{% endif %}</div>              </div>        </div>      </div>    </div>  </div></div>
      `.wrapper() %>",
      "session_loss_desktop": true,
      "session_loss_mobile": 10,
      "show_timeout": "1",
      "close_timeout": "0",
      "show_animation_type": "fade",
      "close_animation_type": "fade"
    }
  ]
}
